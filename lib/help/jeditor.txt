=== 自動拾いエディタの使い方 ===

 「自動拾いエディタ」は「自動拾い/破壊」の設定を書くための専用のテキス
 トエディタです。

 ゲーム中に 「_」キーを押すか、オプション画面で「(P) 自動拾いエディタ」
 を選択するとエディタ画面に入ります。

 エディタを終了するには ^Q を押してください。
 (変更は常に自動的にセーブされます。)

 ESCキーを押すとメニューが開きます。
+----------------------------+
| a) セーブして終了       ^Q |
| b) 全ての変更を破棄     ^Z |
| c) ヘルプ                  |
| d) カーソル移動         ▼ |
| e) 編集                 ▼ |
| f) 検索                 ▼ |
| g) 色々挿入             ▼ |
| h) 拾い/破壊/放置の選択 ▼ |
| i) 形容詞(一般)の選択   ▼ |
| j) 形容詞(特殊)の選択   ▼ |
| k) 名詞の選択           ▼ |
+----------------------------+
 ここで、 a〜k のキーを押すとコマンドを実行するか、またはサブメニュー
 (▼と表示されている行)を開きます。

 行の右端に「^Q」や「^Z」と表示されているコマンドは、メニューを開かず
 に^Qや^Zを押す事で直接実行できます。


--- 使用例１ 基本的な書き方 ---

 あなたは空腹充足の呪文を持っていて、もはや食料を必要としないので、食料
 を自動破壊したいとします。まず、「食料」と書き込んでみましょう

食料

 自動拾いエディタはテキストエディタなのでキーを入力すればそのまま書き込
 まれます。カーソルキーで入力位置を移動できます。
 たった今「食料」と書いた行にカーソルを合わせると、画面下に

全てのアイテムで、名前が「食料」を含むものを拾う。全体マップ('M')で'M'を押したと
きに表示する。

 と表示されます。これでは自動的に拾ってしまいます。
 自動破壊に設定する為には行の先頭に自動破壊を意味する文字「!」を書き込
 みます。

!食料

 そうすると、画面下の説明文が、

全てのアイテムで、名前が「食料」を含むものを破壊する。全体マップ('M')で'K'を押し
たときに表示する。

 に変わりました。変愚蛮怒はちゃんと設定の意味を理解しているようです。
 ^Qを押してエディタを終了すれば設定は終わりです。


--- 使用例２ 持っているアイテムの名前を挿入 ---

 あなたはたった今、鉄のくさび を拾ったとします。あなたはこんな物には興
 味が無いので、自動破壊に設定する事にします。

 しかし、不要な種類のアイテムを拾う度に名前を書き込むのは面倒です。そ
 んな時はESCでメニューを開き「g) 色々挿入 ▼」を選択してみましょう。
+------------------------------------------+
| a) 選択したアイテムの名前を挿入       ^I |
| b) 自動破壊されたアイテムの名前を挿入    |
| c) 条件分岐ブロックの例を挿入            |
| d) マクロ定義を挿入                      |
| e) キーマップ定義を挿入                  |
+------------------------------------------+
 この中の、「a) 選択したアイテムの名前を挿入 ^I」が役に立ちそうです。
 このコマンドはメニューの中で「a」を押すか、メニューを開かずに「コント
 ロールキー」+「I」を押せば実行できます。

 そうすると、このようにアイテムを選択するメニューが現れます。

(持ち物:a-b,'(',')', ESC) どのアイテムを登録しますか?
                                 a) , 4つの 食料
                                 b) ~ 10個の 鉄のくさび

 ここで「b」を押して、鉄のくさびを選択すると、この名前が自動拾いエディ
 タに書き込まれます。

鉄のくさび

 この行の先頭に自動破壊を意味する「!」を書き加えれば完了です。


--- 使用例３ 定型のキーワードをメニューから入力 ---

 今度は、まだ鑑定していない武器を全て拾いたいとします。
 答えを先に言うと、

未鑑定の武器

 と書けばいいのですが、これはメニューから選択する事で入力できます。

 「k) 名詞の選択 ▼」→「a) 武器」
 「i) 形容詞(一般)の選択 ▼」→「b) 未鑑定の」

 の順番に選択すれば完了です。
 他にも多数のキーワードがあるので、手当たり次第に選択すると、

(;*鑑定*済みのダイス目の違うダイス目0以上の無価値のエゴ得意武器

 こんな風にしても画面下の表示は、

完全に鑑定済みのダメージダイスが通常より大きいダメージダイスの最大値が0以上の店
で無価値と判定されるエゴアイテムの得意武器を確認の後に拾う。全体マップには表示し
ない

 ちゃんと解読してくれます。
 ちなみに「ダイス目0以上の」の中の数字は自分で書き変えましょう。


--- カット&ペースト ---

似たような行を沢山書きたい時や、行の順番を入れ換えたい時にはカットとペー
ストが便利です。
「e) 編集 ▼」サブメニューを開くと、
+------------------------+
| a) カット           ^X |
| b) コピー           ^C |
| c) ペースト         ^V |
| d) 選択範囲の指定   ^G |
| e) 行の残りを削除   ^K |
| f) 1文字削除        ^D |
| g) バックスペース   ^H |
| h) 改行             ^J |
| i) 改行             ^M |
+------------------------+
このようなコマンドがあります。

テキストの選択範囲はシフトキーを押しながらカーソルキーを押す事で選択で
きます。ただし、変愚蛮怒の使用環境によってはうまくシフト+カーソルを認
識できないかもしれません。その場合は ^G を押した後でカーソルを移動する
事で選択範囲を指定できます。



***** <Autopick>
==== アイテム自動拾い/破壊設定ファイル ====

ユーザーディレクトリに"picktype.prf"又は "picktype-<名前>.prf" という
ファイルを作って各行にアイテムの名前を書くと、変愚蛮怒にそのアイテムを
自動的に拾ったり破壊するように指示する事ができます。

この設定ファイルは以下のタイミングで読み込まれます。
●ゲームを始める時。
●自動拾いエディタを終了した時。
●'$'コマンドを使った時。(外部のエディタで設定を書き変えた時に使用)

ファイルの中身は、例えば次のように書きます。
---------
賞金首のアイテム
!の死体
!の骨
未判明の薬
~未鑑定の光源
~未鑑定の武器
~未鑑定の防具
*破壊*
抹殺
体力回復
スピードの
致命傷の治癒の薬
---------

もっと実用的な設定例は (autopick.txt [c]) を参照してください。条件分岐を持ち
いてどの職業でも快適に自動拾い/破壊を使えます。

***** [c] ../autopick.txt

--- 自動拾い/破壊の基本書式 ---

基本的に、名前の一部にファイルに書いた文字列が含まれていれば、そのアイ
テムを自動的に拾います。ただし頭に…、

・「!」がついている場合はそのアイテムを自動的に破壊します。
・「~」がついている場合は拾いも破壊もせずに床に残します。
・「;」がついている場合は拾う前に確認メッセージが出ます。

さらに、これらに加えて、「(」を付け加える事でマップコマンド中でのその
アイテムの表示を抑止する事ができます。(以下のTipsを参照してください。)
picktype.prf の先頭から順番に優先的に評価するので、不要なものの破壊の
設定の下にその他のアイテムを拾う設定を書いたり、高級なアイテムを拾う設
定の下にその他の低質なアイテムを破壊する設定を書くのが便利な方法です。

自動拾いや破壊や放置として設定されたアイテムはダンジョンの全体図'M'コ
マンドの中でその位置と名前を表示する事ができます。設定コマンドの説明
(jcommdesc.txt#Looking [d])のダンジョンの全体図を表示を参照してくださ
い。

***** [d] jcommdesc.txt#Looking

--- 特別なキーワード ---

各行の以下のようなキーワードで始まるものは特別扱いになります。

・すべての〜        : すべてのアイテムが対象になります。
・収集中の〜        : 既に同じ種類の物を持っているアイテムが対象になります。
・未判明の〜        : 効果の分からないアイテムが対象になります。
・鑑定済みの〜      : 鑑定されているアイテムが対象になります。
・*鑑定*済みの〜    : *鑑定*されているアイテムが対象になります。
・ダイス目の違う〜  : 殺戮の武器等でダイスの目が通常と異なるアイテムが対象になります。
・ダイス目n以上の〜 : ダイス数×面数が n 以上のアイテムが対象になります。
・修正値n以上の〜   : 能力修正値が(+n)以上のアイテムが対象になります。
                      能力修正が無い場合は他の数値が+n以上なら対象になります。
・無価値の〜        : 価値のない(売却できない)アイテムが対象になります。
・アーティファクト〜: 判明しているアーティファクトが対象になります。
・エゴ〜            : 判明しているエゴアイテムが対象になります。
・無銘の〜          : 非エゴ, 非アーティファクトのアイテムが対象になります。
・賞金首の〜        : 賞金首の死体または骨が対象になります。
・ユニーク・モンスターの〜： ユニーク・モンスターの死体、骨、彫像が対象になります。
・人間の〜          : 人間の死体または骨が対象になります。(悪魔魔法で使用)
・読めない〜        : 専門としない魔法領域の魔法書が対象になります。
・第一領域の〜      : 第一領域の魔法書が対象になります。
・第二領域の〜      : 第二領域の魔法書が対象になります。
・n冊目の           : nが1から4のとき、n冊目の魔法書が対象になります。

〜の部分では、アイテムの種類を表す以下のようなキーワードが特別扱いになります

・アイテム          : すべてのアイテムが対象になります。
・武器              : 武器が対象になります。
・防具              : 防具が対象になります。
・矢                : 矢、クロスボウの矢、石、弾が対象になります。
・光源              : たいまつやランタン等が対象になります。
・魔法アイテム      : 巻物・杖・魔法棒・ロッドが対象になります。
・がらくた          : 折れた棒や像等の役に立たないものが対象になります。
・魔法書            : 魔法書、武芸の書、歌集が対象になります。
・得意武器          : プリースト、修行僧、魔獣使い、練気術師、騎兵、忍者にとって、
                      特別に扱いやすい種類の武器が対象になります。

他に部位別の装備品を対象とするキーワード: 盾、弓、指輪、アミュレット、
鎧、クローク、兜、籠手、靴 が使用できます。

この後に区切り記号のコロン「:」を挟んでさらに文字列が続く場合は、その
文字列が名前の一部に含まれているアイテムが対象になります。ここで、アイ
テムの種類を表すキーワード(アイテム、武器、防具等) を使用しない場合は
区切り記号は省略できます。また、文字列の頭に記号「^」を入れるとそれは
アイテム名の先頭部分に一致します。具体的には以下のように解釈されます。

光源:石          // 名前に"石"を含む光源を拾う。「光源石」 は使用不可。
籠手:腕力の      // 腕力のガントレットを拾うが、腕力の指輪は拾わない。
!ローブ          // 名前に"ローブ"を含むもの(ローブ、グローブ等)を破壊。
!^ローブ         // グローブは破壊しない。
!防具:^耐        // 耐火、耐冷、耐電、耐酸の防具を破壊。全耐性は破壊しない。

また、行の最後に # で始まる文字列を書くと、鑑定したりアイテムの
上に立った瞬間に自動的にその文字列がアイテムに刻まれます。


--- 厳密な書式 ---

各行の厳密な書式は以下のような順番です。未鑑定の や ダイス目の違う 等
のキーワードは一行に並べて書く事で両方の制限を適用させる事が出来ます。
現在のバージョンではキーワードの順番も自由です。

   [! ~ ; (]
   [[すべての] [収集中の]
    [未判明の] [未鑑定の] [鑑定済みの] [*鑑定*済みの]
    [ダイス目の違う] [ダイス目n以上の] [修正値n以上の]
    [無価値の] [アーティファクト] [エゴ] [無銘の]
    [賞金首の] [ユニーク・モンスターの] [人間の]
    [読めない] [第一領域の] [第二領域の] [n冊目の]
    [アイテム|アーティファクト|武器|防具|矢|光源|魔法アイテム|
     がらくた|魔法書|鈍器|盾|弓|指輪|アミュレット|鎧|クローク|
     兜|籠手|靴] :]
   [[^]その他の文字列] [#自動刻み文字列]


***** <Condition>
=== 条件付きの設定ファイル ===

全てのユーザー設定ファイルは、種族や職業、レベル等に条件を付けて設定す
ることが出来ます。特に自動拾いやマクロの設定に利用すると便利です。


---  条件分岐の書式  ---

?:引数

   引数が"0"なら以降の自動拾い／破壊の登録をスキップする。
   引数が"1"なら以降の登録を行う。 引数が"0"以外は全て"1"と見なす。

 (注意!)条件分岐を入れ子にすることは出来ません。


---  使用可能な演算子  ---

特別な文字列といくつかの引数のリストを'['と']'で囲むことと演算子として
の働きをして、結果が真 "1" であるか、 偽 "0" であるかを返します。

[EQU 引数１ 引数２ ...]
   全ての引数が等しいとき"1"、等しくないとき"0"を返す。

[IOR 引数１ 引数２ ...]
[AND 引数１ 引数２ ...]
   IORは引数の論理和、ANDは引数の論理積をとって真なら"1"、偽なら"0"を
   返す。

[NOT 引数]
   引数が"1"なら"0"、"0"なら"1"を返す。

[LEQ 引数１ 引数２ ...]
[GEQ 引数１ 引数２ ...]

   LEQは引数の大きさを「文字列として比較」して引数１≦引数２≦...のと
   き"1"を返す。GEQは引数１≧引数２≧...のとき"1"を返す。


---  変数説明  ---

条件判定分の中で、'$'で始まるいくつかの文字列は自動的にキャラクターの
状態を表わす文字列に置き変えられます。

$RACE
   種族を英語名で返す。
   Human, Half-Elf, Elf, Hobbit, Gnome, Dwarf, Half-Orc, Half-Troll,
   Amberite, High-Elf, Barbarian, Half-Ogre, Half-Giant, Half-Titan,
   Cyclops, Yeek, Klackon, Kobold, Nibelung, Dark-Elf, Draconian,
   Mindflayer, Imp, Golem, Skeleton, Zombie, Vampire, Spectre, Sprite,
   Beastman, Ent, Archon, Balrog, Dunadan, Shadow-Fairy, Kuta,
   Android
   のどれか

$CLASS
   職業を英語名で返す。
   Warrior, Mage, Priest, Rogue, Ranger, Paladin, Warrior-Mage,
   Chaos-Warrior, Monk, Mindcrafter, High-Mage, Tourist, Imitator,
   BeastMaster, Sorcerer, Archer, Magic-Eater, Bard, Red-Mage,
   Samurai, ForceTrainer, Blue-Mage, Cavalry, Berserker, Weaponsmith,
   Mirror-Master, Ninja
   のどれか

$PLAYER
   プレイヤーの名前を返す。

$REALM1
   魔法領域を英語名で返す。
   Life, Sorcery, Nature, Chaos, Death, Trump Arcane, Craft, Daemon,
   Crusade, Music, Kendo
   のどれか

$REALM2
   第２魔法領域を英語名で返す。

$LEVEL
   プレイヤーのレベルを２桁の文字列で返す。
   "01","09","10","50" 等


---  ファイルの挿入の書式  ---

%:ファイル名
   lib\user\ファイル名 か ~/.angband/Hengband/ファイル名 を自
   動拾いの登録ファイルとして読み込みます。

(*警告!!*) 自分自身(例えばpicktype.prf)を読み込んでしまうと永久ループ
           になってクラッシュするので絶対やらないように。


--- 自動拾い設定に活用した例 ---

?:[EQU $CLASS Magic-Eater]
のロッド
の杖
の魔法棒

?:[EQU $CLASS Archer]
の骨

?:[EQU $CLASS Ninja]
~光源:暗闇の
鉄のくさび#@v0

?:[EQU $RACE Vampire]
(~暗闇の巻物
(~暗闇の杖
?:1

?:[GEQ $LEVEL 20]
(!無銘の武器:(+0,+0)
(!無銘の防具:,+0]
?:1

?:[AND [GEQ $LEVEL 20] [IOR [EQU $REALM1 Life] [EQU $REALM2 Life] [EQU $REALM1 Nature] [EQU $REALM2 Nature] [EQU $REALM1 Craft] [EQU $REALM2 Craft]]]
(!空腹充足
(!食料
(!スライムモルド
(!エルフの行糧
?:1
